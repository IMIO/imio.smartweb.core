<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/@@main_template/macros/master"
      i18n:domain="plone">
<body>

<metal:main fill-slot="content-core">
<metal:content-core define-macro="content-core">
<div tal:define="can_edit python: checkPermission('Modify portal content', context);
                 token context/@@authenticator/token;
                 items context/listFolderContents;"
     tal:attributes="class string:section_gallery ${context/bootstrap_css_class}">

  <tal:if tal:define="show_section python: can_edit or items"
          tal:condition="show_section">

    <div class="content-section"
         tal:define="hide_title context/hide_title"
         tal:attributes="style view/background_style"
         i18n:domain="imio.smartweb">

      <tal:if tal:condition="not: hide_title">
        <h2 tal:content="context/title" />
        <tal:edit tal:condition="can_edit">
          <span class="glyphicon-eye-close glyphicon"></span>
          <a tal:attributes="href string:${context/absolute_url}/@@hide_section_title?_authenticator=${token}"
             i18n:translate="">Hide title</a>
        </tal:edit>
      </tal:if>
      <tal:else tal:condition="python: can_edit and hide_title">
        <h2 tal:content="context/title"
            class="hidden-section-title" />
        <span class="glyphicon-eye-open glyphicon"></span>
        <a tal:attributes="href string:${context/absolute_url}/@@show_section_title?_authenticator=${token}"
           i18n:translate="">Show title</a>
      </tal:else>

      <div class="header-section" tal:condition="can_edit">
        <span i18n:domain="imio.smartweb" class="manage-section">
          <span class="icon-edit"></span>
          <a class="edit-section" tal:attributes="href string:${context/absolute_url}/edit"
             i18n:translate="">Edit section</a>
          <span class="icon-folderContents"></span>
          <a class="edit-section-content" tal:attributes="href string:${context/absolute_url}/folder_contents"
             i18n:translate="">Manage section contents</a>
          <span class="glyphicon-trash glyphicon"></span>
          <a tal:attributes="href string:${context/absolute_url}/delete_confirmation"
             i18n:translate="">Delete section</a>
        </span>
        <tal:dates define="modified context/get_last_mofication_date">
        <span class="documentModified"
              tal:condition="modified">
          <span i18n:translate="box_last_modified">
            last modified
          </span>
          <span class="pat-moment" data-pat-moment="format:relative;"
                tal:content="modified">
            Modified
          </span>
        </span>
        </tal:dates>
      </div>

      <!-- fix some css for usage in Plone  -->
      <style type="text/css">
       #spotlight .header { padding-right: 120px !important; }
       #content-core a { border-bottom: 0px solid transparent !important;}
      </style>

      <div tal:define="portal context/@@plone_portal_state/portal;
                       thumb_scale context/image_scale"
           tal:condition="items"
           class="flexbin flexbin-margin">
        <tal:images tal:repeat="item items">
          <a class="section_gallery_item" tal:attributes="href string:${item/absolute_url}/@@images/image/large;
                             title item/title;
                             data-description item/description"
             class="spotlight">
            <img tal:attributes="src string:${item/absolute_url}/@@images/image/${thumb_scale};
                                 alt item/title;
                                 title item/title" />
          </a>
        </tal:images>
      </div>
    </div>
  </tal:if>

</div>
</metal:content-core>
</metal:main>

</body>
</html>
